<!DOCTYPE HTML>
<html>
<head>
	<meta charset="utf8">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
	<style>
	.cell {
		width: 150px;
		display: inline-block;
		vertical-align: top;
		height: 100px;
		position: relative;
		text-decoration: none;
		overflow: hidden;
		box-shadow: 0 1px 2px #888;
		margin: 5px;
		padding: 5px;
		color: #000;
	}
	.cell .name {display: block;text-align: center;}
	.cell .desc {display: block;text-align: center;}
	.cell .date {position:absolute;bottom:0;left :0;width:100%;background-color: #FFF;}
	.cell .lang {position:absolute;bottom:0;right:0;}
	</style>
	<script src="$.js"></script>
	<script>
		function showAll(repos,contents){
			var list=repos.concat(contents)
				.filter(function(a){return !(a.type&&a.type!='dir')})
				.sort(function(a,b){return b.name.toLowerCase()<a.name.toLowerCase();})
			$.empty(document.body).appendChild($.toNode(['div'].concat(list.map(function(el){
				var isweb=(el.default_branch=='gh-pages')||el.type;
				return ['a',{"class":'cell '+(isweb?'app':'repo'),href:isweb?el.name:el.html_url,draggable:true},
				['span',{'class':'name'},(el.full_name||'/'+el.name).split('/').slice(1).join('')],
				['span',{'class':'desc'},(el.description||'')],
				['span',{'class':'date'},(el.updated_at?(new Date(el.updated_at)).toLocaleDateString():'')],
				['span',{'class':'lang'},(el.language||'web')],
			]}))))
		};
		function fetch(host){//retreive webapps/repo
			$.get(host+'users/yne/repos',function(repos){
				$.get(host+'repos/yne/yne.github.io/contents/',function(yne){
					showAll(JSON.parse(repos.target.response),JSON.parse(yne.target.response));
				})
			});
		}
	</script>
</head>
<body onload="fetch('https://api.github.com/')">
	<div class="wait">...</div>
</body>
</html>
