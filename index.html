<!DOCTYPE HTML>
<html lang="en">
<head>
<title>YNE repositories</title>
<meta charset="utf-8"/>
<meta name="Description" content="list of public yne repositories">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"/>
<style>
@keyframes slide{from{transform:scale(0);}to{transform:scale(1);}}
@media screen and (max-width:35.5em){.cell{display:block;width: auto;}}
@media screen and (min-width:35.5em){body{font-size:1.0em;}}
@media screen and (min-width:48.5em){body{font-size:1.2em;}}
@media screen and (min-width:64.0em){body{font-size:1.5em;}}
@media screen and (min-width:80.0em){body{font-size:1.7em;}}
body{background:#EEE;font-size:1.4em;font-family:sans-serif;}
*{transition: .2s all linear;}
a{text-decoration: none;color: #444;}
.cell{width:8em;height:6em;display: inline-block;position: relative;}
.cell{box-shadow:0 .1em .2em;margin:.5em;background:#FFF;animation:slide .5s;}
.cell:hover{color:#000;box-shadow:0 .2em .4em;}
.cell>*{overflow:hidden;padding:.2em;position:absolute;text-align:center;display:block;}
.cell .name{left:0;right:0;top:0;background:#EEE;}
.cell .desc{font-size:.8em;left:0;right:0;top:2em;bottom:1.5em;}
.cell .date{font-size:.7em;bottom:0;left :0;}
.cell .lang{font-size:.7em;bottom:0;right:0;}
.cell .memo{background:#FFF;border:none;}
.cell .memo:hover{cursor:help;}
.cell:hover .memo.empty{opacity:.8;}
.cell .memo.empty{opacity:.0;}
</style>
<script>
$$=function(sel,node){return [].slice.call((document||node).querySelectorAll(sel));}
$=function(sel,node){return (document||node).querySelector(sel);}
$.empty=function(node){[].slice.call(node.childNodes).forEach(function(child){node.removeChild(child)});return node;}
$.get=function(url,cb){
	var xhr = new XMLHttpRequest();
	xhr.onload=cb;
	xhr.open('GET',url);
	xhr.send();
}
$.toNode=function(jsonML){
	var node=document.createElement(jsonML.shift());
	jsonML.forEach(function(j){
		if(j)switch(j.constructor){
			case Array :node.appendChild($.toNode(j));break;
			case Object:for(attr in j){
				//if(attr.match(/^on/))node.addEventListener(attr.substr(2),j[attr],false);
				if(attr.match(/^on/))node[attr]=j[attr];//event attribut
				else node.setAttribute(attr,j[attr])//other attribut
			};break;
			case String:node.appendChild(document.createTextNode(j));break;
		}
	});
	return node;
}
function showAll(repos,contents){
	var o=(localStorage['cell_order']||'').split(',');
	var list=repos.concat(contents).filter(function(a){return !(a.type&&a.type!='dir')})
		.sort(function(a,b){return b.name.toLowerCase()<a.name.toLowerCase()});
	$.empty(document.body).appendChild($.toNode(['main'].concat(list.map(function(el){
		var title=(el.full_name||'/'+el.name).split('/').slice(1).join('');
		var rand=title.split('').reduce(function(prev,cur,i,a){return prev+cur.charCodeAt(0)},0);
		var color='#'+(0xDDD+parseInt((rand%26).toString(3),16)).toString(16);
		var isweb=(el.default_branch=='gh-pages')||el.type;
		var memo=localStorage['memo_'+title]
		return ['a',{/*style:'transform: rotate('+((rand%20)-10)/5+'deg)',*/
				ondragstart:function(e){e.dataTransfer.effectAllowed='move';e.dataTransfer.setData('id',this.id)},
				ondragover :function(e){if(e.preventDefault)e.preventDefault();e.dataTransfer.dropEffect='move';},
				ondrop     :function(e){if(e.preventDefault)e.preventDefault();
					this.parentElement.insertBefore(document.getElementById(e.dataTransfer.getData('id')),this)
					localStorage['cell_order']=$$('.cell').map(function(a){return a.id}).join(',')
				},
			},{"class":'cell '+(isweb?'app':'repo'),id:title,href:isweb?el.name:el.html_url,draggable:true},
			['span',{'class':'name',style:'background:'+color+';cursor:move'},title],
			['span',{'class':'desc'},(el.description||'')],
			['span',{'class':'date'},(el.updated_at?(new Date(el.updated_at)).toLocaleDateString():'')],
			['span',{'class':'lang'},(el.language||'web')],
			['button',{'class':'memo '+(memo?'':'empty'),title:memo||'Add a TODO reminder',onclick:function(){
				var p=prompt('',localStorage['memo_'+title]||'');
				if(p!=null){localStorage['memo_'+title]=p;this.classList.remove('empty');}
				if(p=="")this.classList.add('empty');
				return false}},'\u2713'],
		]}))))
};
function fetch(host){//retreive webapps/repo
	$.get(host+'users/yne/repos',function(repos){
		$.get(host+'repos/yne/yne.github.io/contents/',function(yne){
			showAll(JSON.parse(repos.target.response),JSON.parse(yne.target.response))
		})
	})
}
</script>
</head>
<body onload="fetch('https://api.github.com/')">
	<main class="wait">Loading repositories...</main>
	<noscript>
	<ul>
		<li><a href="https://github.com/yne?tab=repositories">My Repositories</a></li>
		<li><a href="https://gist.github.com/yne">My Snippets</a></li>
	</ul>
	</noscript>
</body>
</html>
