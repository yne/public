<html>
<head>
<meta charset="utf8">
<script>
var $ =document.querySelector.bind(document);
var $$=document.querySelectorAll.bind(document);

var worker = new Worker("worker.js");
worker.onmessage=function(arg){
	var type=arg.data[0],data=arg.data[1];
	switch(type){
		case 'progress':$('#progress').value=+data;break;
		case 'result':$('#files').innerHTML+='<li><a href="'+data.href+'">'+data.name+'.'+data.type+'</a></li>';break;
		default:;
	}
};

function loadFiles(){
	var reader = new FileReader();
	reader.onloadend = function(){worker.postMessage(this.result)};
	reader.readAsArrayBuffer($('[type=file]').files[0]);
}
</script>
</head>
<body>
	<form onsubmit="loadFiles()"><input type="file" onchange="loadFiles()"></form>
	<progress id="progress" value="0" max="1">60%</progress>
	<ul id="files">
	</ul>
</body>